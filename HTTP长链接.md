# HTTP 长链接

## 1. 作用

- 可以更高效当传输资源，现在大多数当网站都使用了 keep-alive 模式，加快网页的加载。也就是说开启 keep-alive 模式后，tcp/ip链接会被重复使用，浏览器和服务器创建了6个 tcp/ip 之后就不会再创建新的 tcp/ip 链接，直到长链接被关闭。
- 服务器可以将资源并发给浏览器，但是浏览器限制了同一域名下的并发数量，chrome 为6个，也就是说 chrome 限制了 tcp/ip 链接的创建数量为6，如果需要同时传输第七个资源，那么此时第七个资源会复用之前的六个中的其中一个，这就产生了队头阻塞效应。所以如果需要使用不同的服务器并发资源，达到首屏渲染的最高效，一般我们会将静态资源放在 CDN 上。
- 可以在 chrome 上的 dev-tool 的 network 中，打开 connectId 的显示，就可以观察到 tcp/ip 的 id 了。

---

## 2. 使用方法

- 浏览器端和服务器端都可以设置`Connection: keep-alive`，如果服务器端没有设置，HTTP 长链接不会启动。

---

## 3. HTTP 2.0

- 在 HTTP 2.0 中新增了信道复用的功能，也就是实现了在 tcp/ip 链接上的并发，这样我们在访问网站的时候只需要复用一个 tcp/ip 链接就可以进行资源的并发传输了。这样就降低了创建多个 tcp/ip 的开销（google 的所有网站都使用了 HTTP 2.0）